import{r as T,o as y,c as S,a as d,b as k,d as L,e as O,E as i,l as P,f as A,g as R,h as m,i as w,z as x}from"./vendor.b267fb73.js";const N=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerpolicy&&(o.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?o.credentials="include":t.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}};N();var b=(e,n)=>{const r=e.__vccOpts||e;for(const[s,t]of n)r[s]=t;return r};const I={};function z(e,n){const r=T("router-view");return y(),S(r)}var $=b(I,[["render",z]]);const K={token:e=>e.user.token,user:e=>e.user.user},f="Authorization";function U(){return d.get(f)}function J(e){d.set(f,e)}function g(){d.remove(f)}const j="modulepreload",h={},C="/",p=function(n,r){return!r||r.length===0?n():Promise.all(r.map(s=>{if(s=`${C}${s}`,s in h)return;h[s]=!0;const t=s.endsWith(".css"),o=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${o}`))return;const a=document.createElement("link");if(a.rel=t?"stylesheet":j,t||(a.as="script",a.crossOrigin=""),a.href=s,document.head.appendChild(a),t)return new Promise((E,v)=>{a.addEventListener("load",E),a.addEventListener("error",v)})})).then(()=>n())},Z=[{path:"/",name:"Index",component:()=>p(()=>import("./Index.9f650ddf.js"),["assets/Index.9f650ddf.js","assets/vendor.b267fb73.js"])},{path:"/login",name:"Login",component:()=>p(()=>import("./Login.53c660ac.js"),["assets/Login.53c660ac.js","assets/Login.908d3b27.css","assets/vendor.b267fb73.js"])}],l=k({history:L(),routes:Z}),q=[{path:"/manage",name:"Manage",component:()=>p(()=>import("./Index.1ea7671d.js"),["assets/Index.1ea7671d.js","assets/vendor.b267fb73.js"])}],u=O.create({baseURL:"/prod-api",timeout:1e4});u.interceptors.request.use(e=>(c.getters.token&&(e.headers.Authorization="Bearer"+c.getters.token),e));u.interceptors.response.use(e=>e.data,e=>{let{message:n}=e;return n.includes("timeout")?(e.response.data.msg="\u63A5\u53E3\u8BF7\u6C42\u8FDE\u63A5\u8D85\u65F6",i.warning("\u63A5\u53E3\u8BF7\u6C42\u8FDE\u63A5\u8D85\u65F6")):n==="Network Error"&&(e.response.data.msg="\u540E\u7AEF\u63A5\u53E3\u8FDE\u63A5\u5F02\u5E38",i.error("\u540E\u7AEF\u63A5\u53E3\u8FDE\u63A5\u5F02\u5E38")),e.response.status===401?(g(),c.commit("user/SET_TOKEN",void 0),c.commit("user/SET_USER",void 0),l.currentRoute.value.path.includes(q[0].path)&&l.replace({path:"/login",query:{redirect:l.currentRoute.value.fullPath}}).then().catch(),i.error(e.response.data.msg)):e.response.status===500||e.response.status===400||e.response.status===404?i.error(e.response.data.msg||"\u670D\u52A1\u5668\u5F00\u5C0F\u5DEE\u4E86~"):e.response.status===403?i.warning(e.response.data.msg):e.response.status===405&&i.warning(e.response.data.msg),Promise.reject(e.response.data)});function M(){return u("/user/profile",{method:"GET"})}function Q(e){return u("/login",{method:"POST",data:P.stringify(e)})}function B(){return u("/logout",{method:"POST"})}const D={token:U(),user:void 0},V={SET_TOKEN:(e,n)=>{e.token=n},SET_USER:(e,n)=>{e.user=n}},W={Profile:({commit:e})=>new Promise((n,r)=>{M().then(s=>{let t=/^(http:\/\/|https:\/\/|\/\/)?(([A-Za-z0-9]+-[A-Za-z0-9]+|[A-Za-z0-9]+)\.)+([A-Za-z]+)[/?:]?.*$/;s.data.avatar=t.test(s.data.avatar)?s.data.avatar:"/prod-api"+s.data.avatar,e("SET_USER",s.data),n(s)}).catch(s=>{r(s)})}),Logout:({commit:e})=>new Promise((n,r)=>{B().then(()=>{e("SET_TOKEN",void 0),e("SET_USER",void 0),n()}).catch(()=>{e("SET_TOKEN",void 0),e("SET_USER",void 0),r()}),g(),i.success("\u6CE8\u9500\u6210\u529F")})};var F={namespaced:!0,state:D,mutations:V,actions:W},c=A({modules:{user:F},getters:K});function G(e){return e.replace(/[A-Z]/g,n=>"-"+n.toLowerCase())}const _=R($);for(let e in m)_.component(G(e),m[e]);_.use(l).use(c).use(w,{locale:x}).mount("#app");export{b as _,Q as l,J as s};
//# sourceMappingURL=index.5e9e5d1e.js.map
